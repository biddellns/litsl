---


 - name: Install minimum dependencies
   become: true
   apt: "name={{ item }} update_cache=yes state=installed"
   with_items:
              - python3-pip
              - python3-dev
              - libpq-dev
              - postgresql
              - postgresql-contrib
              - nginx
   tags: packages

 - name: Install mkvirtualenv
   become: true
   pip: "name={{ item }} executable=/usr/bin/pip3"
   with_items:
              - mkvirtualenv  

 - name: Add config settings to .bashrc
   lineinfile:
      dest=~/.bashrc
      regexp="^export WORKON_HOME=$HOME/.virtualenvs\n
               export PROJECT_HOME=$HOME/Devel\n
               source /usr/local/bin/virtualenvwrapper.sh"
      state=present
      insertafter=EOF
      line="export WORKON_HOME=$HOME/.virtualenvs\n
             export PROJECT_HOME=$HOME/Devel\n
             source /usr/local/bin/virtualenvwrapper.sh"
    
